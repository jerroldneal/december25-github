# MCP Speak Setup Guide

## Overview
This guide explains how to integrate the Kokoro TTS MCP server into your VS Code projects to enable the `mcp_kokoro-tts_speak` tool. This allows AI agents to "speak" to you directly using high-quality local text-to-speech.

## Prerequisites
- Docker Desktop installed and running.
- VS Code with the MCP extension (or similar MCP client).

## 1. Start the TTS Service
The service runs as a Docker container. You need to have the `device-proxy-tts-kokoro-processor` project available.

1. Navigate to the `device-proxy-tts-kokoro-processor` directory.
2. Run the container using Docker Compose:
   ```bash
   docker-compose up -d
   ```

   **Note:** Ensure ports `3021` (SSE) and `3022` (Dashboard) are not in use.

3. Verify the container is running:
   ```bash
   docker ps
   ```
   You should see `tts-kokoro-processor-instance` in the list.

## 2. Configure VS Code
To allow your current VS Code workspace to access the tool, you must configure the MCP client.

1. Create or open the `.vscode/mcp.json` file in your project root.
2. Add the `kokoro-tts` entry to the `servers` object:

```json
{
  "servers": {
    "kokoro-tts": {
      "type": "sse",
      "url": "http://localhost:3021/sse"
    }
  }
}
```

3. **Restart the MCP Server**:
   - Open the Command Palette (`Ctrl+Shift+P`).
   - Run `Developer: Reload Window` to force a reconnection.

## 3. Verification
1. Open the **MCP Servers** view in VS Code (usually in the sidebar).
2. Verify that `kokoro-tts` is listed and shows a "Connected" status (green indicator).
3. Test the tool by asking Copilot:
   > "Say 'System check complete'."

4. You should hear the audio output immediately.

## Troubleshooting

### Connection Refused
- **Symptom**: The MCP server shows "Disconnected" or "Connection refused".
- **Fix**:
  - Ensure the Docker container is running (`docker ps`).
  - Check if the URL `http://localhost:3021/sse` is accessible via `curl` or browser.

### No Audio Output
- **Symptom**: The tool executes successfully, but no sound is heard.
- **Fix**:
  - The container relies on an audio pipe or TCP forwarder to play sound on the host.
  - Ensure the `forward_pipe.sh` script (or equivalent mechanism) is running if you are using a pipe-based setup.
  - Check container logs for errors: `docker logs tts-kokoro-processor-instance`.

### "Fetch failed" Error
- **Symptom**: Error sending message to SSE endpoint.
- **Fix**: This often happens if the server crashed or is restarting. Check logs:
  ```bash
  docker logs tts-kokoro-processor-instance --tail 50
  ```

## Tool Reference
The server exposes the following tool:

### `mcp_kokoro-tts_speak`
Converts text to speech using the Kokoro model.

- **Arguments**:
  - `text` (string, required): The text to speak.
  - `voice` (string, optional): Voice ID (default: `af_heart`).
    - Options: `af_heart`, `af_bella`, `af_nicole`, `af_sarah`, `af_sky`, `am_adam`, `am_michael`, `bf_emma`, `bf_isabella`, `bm_george`, `bm_lewis`.
  - `speed` (number, optional): Speech speed (default: `1.0`).

---
*Generated by GitHub Copilot*
